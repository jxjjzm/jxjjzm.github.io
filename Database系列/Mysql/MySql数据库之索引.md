### MySql数据库之索引 ###
***

### 一、索引使用篇 ###

说到索引，很多人都知道“索引是一个排序的列表，在这个列表中存储着索引的值和包含这个值的数据所在行的物理地址，在数据十分庞大的时候，索引可以大大加快查询的速度，这是因为使用索引后可以不用扫描全表来定位某行的数据，而是先通过索引表找到该行数据对应的物理地址然后访问相应的数据。”

#### I、索引有什么好处？ ####



- 提高数据的检索速度，降低数据库IO成本：使用索引的意义就是通过缩小表中需要查询的记录的数目从而加快搜索的速度。
- 降低数据排序的成本，降低CPU消耗：索引之所以查的快，是因为先将数据排好序，若该字段正好需要排序，则正好降低了排序的成本。

#### II、索引有什么坏处？ ####


- 占用存储空间：索引实际上也是一张表，记录了主键与索引字段，一般以索引文件的形式存储在磁盘上。
- 降低更新表的速度：表的数据发生了变化，对应的索引也需要一起变更，从而减低的更新速度。否则索引指向的物理数据可能不对，这也是索引失效的原因之一。

#### III、索引的使用场景？ ####



- 对非常小的表，大部分情况下全表扫描效率更高。
- 对中大型表，索引非常有效。
- 特大型的表，建立和使用索引的代价随着增长，可以使用分区技术来解决。


实际场景下，MySQL 分区表很少使用，对于特大型的表，更常用的是“分库分表”，目前解决方案有 Sharding Sphere、MyCAT 等等。


- 分区表，分区键设计不太灵活，如果不走分区键，很容易出现全表锁
- 一旦数据量并发量上来，如果在分区表实施关联，就是一个灾难
- 自己分库分表，自己掌控业务场景与访问模式，可控。分区表，研发写了一个sql，都不确定mysql是怎么玩的，不太可控
- 运维的坑，嘿嘿


#### IV、索引的类型？ ####

索引，都是实现在存储引擎层的。主要有六种类型：

- 普通索引：最基本的索引，没有任何约束。
- 唯一索引：与普通索引类似，但具有唯一性约束。
- 主键索引：特殊的唯一索引，不允许有空值。
- 复合索引：将多个列组合在一起创建索引，可以覆盖多个列。
- 外键索引：只有InnoDB类型的表才可以使用外键索引，保证数据的一致性、完整性和实现级联操作。
- 全文索引：MySQL 自带的全文索引只能用于 InnoDB、MyISAM ，并且只能对英文进行全文检索，一般使用全文索引引擎。



#### V、MySQL 索引的“创建”原则？ ####


- 最适合索引的列是出现在 WHERE 子句中的列，或连接子句中的列，而不是出现在 SELECT 关键字后的列。
- 索引列的基数越大，索引效果越好。
- 根据情况创建复合索引，复合索引可以提高查询效率。因为复合索引的基数会更大。
- 避免创建过多的索引，索引会额外占用磁盘空间，降低写操作效率。
- 主键尽可能选择较短的数据类型，可以有效减少索引的磁盘占用提高查询效率。
- 对字符串进行索引，应该定制一个前缀长度，可以节省大量的索引空间。



#### VI、MySQL 索引的“使用”注意事项？ ####



- 应尽量避免在 WHERE 子句中使用 != 或 <> 操作符，否则将引擎放弃使用索引而进行全表扫描。优化器将无法通过索引来确定将要命中的行数,因此需要搜索该表的所有行。注意，column IS NULL 也是不可以使用索引的。
- 应尽量避免在 WHERE 子句中使用 OR 来连接条件，否则将导致引擎放弃使用索引而进行全表扫描，如：SELECT id FROM t WHERE num = 10 OR num = 20 。
- 应尽量避免在 WHERE 子句中对字段进行表达式操作，这将导致引擎放弃使用索引而进行全表扫描。
- 应尽量避免在 WHERE 子句中对字段进行函数操作，这将导致引擎放弃使用索引而进行全表扫描。
- 不要在 WHERE 子句中的 = 左边进行函数、算术运算或其他表达式运算，否则系统将可能无法正确使用索引。
- 复合索引遵循前缀原则。
- 如果 MySQL 评估使用索引比全表扫描更慢，会放弃使用索引。如果此时想要索引，可以在语句中添加强制索引。
- 列类型是字符串类型，查询时一定要给值加引号，否则索引失效。
- LIKE 查询，% 不能在前，因为无法使用索引。如果需要模糊匹配，可以使用全文索引。


### 二、索引原理篇 ###

索引是在存储引擎层实现的，而不是在服务器层实现的，所以不同存储引擎具有不同的索引类型和实现。


https://mp.weixin.qq.com/s/_effiR7ueOXqH14MO60NVg


https://mp.weixin.qq.com/s/wtUGR_1u9xOCP-IWga9VGA

https://blog.csdn.net/u013235478/article/details/50625677

https://blog.csdn.net/tongdanping/article/details/79878302

https://blog.csdn.net/oChangWen/article/details/54024063





- [数据库索引原理及优化](https://mp.weixin.qq.com/s/wtUGR_1u9xOCP-IWga9VGA)
- [MySQL索引原理](https://blog.csdn.net/u013235478/article/details/50625677)








